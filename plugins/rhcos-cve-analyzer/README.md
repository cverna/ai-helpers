# RHCOS CVE Analyzer

A Claude Code plugin for analyzing and categorizing RHEL CoreOS (RHCOS) CVEs to determine verification readiness.

## Overview

This plugin automates the process of analyzing RHCOS CVE data and categorizing them into actionable groups:

- **verifiable_cves**: CVEs with "Done-Errata" resolution (ready for verification)
- **non_verifiable_cves**: CVEs without "Done-Errata" resolution (skip verification)
- **attention_cves**: Open CVEs with no RHEL issues (need attention)

## Usage

If you want to the command to automatically update JIRA, you also need to install and configure the jira-cli tool.
https://github.com/ankitpokhrel/jira-cli?tab=readme-ov-file#on-premise-installation

### Create a Python Virtual Environment and install dependencies
```bash
$ python3 -m venv venv
$ source venv/bin/activate
$ (venv) pip install requests
```

### Export Environment Variables
```bash
$ (venv) export JIRA_API_TOKEN=.....
$ (venv) export REGISTRY_AUTH_FILE=.....

### Run Claude Code from the Virtual Environment
```bash
$ (venv) claude
```

### Analyze All CVEs
```bash
/analyze-cves
```

### Analyze Specific Status
```bash
/analyze-cves closed
/analyze-cves open
```

## Output Format

Returns structured JSON with three arrays:
- `verifiable_cves`: CVEs ready for verification
- `non_verifiable_cves`: CVEs to skip verification
- `attention_cves`: CVEs requiring attention

Each CVE entry includes:
- `original_data`: The complete 9-element CVE record array
- `reason`: Explanation for the categorization

## Installation

```
/plugin install rhcos-cve-analyzer@ai-helpers
```
## CVE Record Format

Each CVE record contains 9 elements:
`[CVE-ID, Description, OCPBUGS-URL, RHEL-Version, RHEL-Issue-URL, Status, Package-Version, Date, Resolution]`

## Author

Clement Verna
